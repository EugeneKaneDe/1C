Процедура ЗаписьВРегистр(МассивСтрок) Экспорт //:SOV IT EA
	Для Каждого Строка из МассивСтрок Цикл
		РС = РегистрыСведений.РегистрПараметрыОбъекта.СоздатьМенеджерЗаписи();
	    РС.СсылкаНаДокумент = Строка.Ссылка;
	    РС.НаличиеДокументаОригинала = Истина;
	    РС.Записать(Истина);
	КонецЦикла;
КонецПроцедуры

Процедура ПроверкаЗаписиВРегистре(МассивСтрок) Экспорт //:SOV IT EA 
	Для Каждого Строка из МассивСтрок Цикл
		РС = РегистрыСведений.РегистрПараметрыОбъекта.СоздатьНаборЗаписей();
	    РС.Отбор.СсылкаНаДокумент.Установить(Строка.Ссылка);
		РС.Прочитать();
		Для Каждого Стр из РС Цикл
			Если РС.Количество() > 0 Тогда
				Сообщить("Запись в регистре есть");
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
КонецПроцедуры

Процедура ЗаписьВРегистрПриОткрытии (Документ,БулевоНаФорме) Экспорт //:SOV IT EA Нет необходимости
	РС = РегистрыСведений.РегистрПараметрыОбъекта.СоздатьНаборЗаписей();
	РС.Отбор.СсылкаНаДокумент.Установить(Документ.Ссылка);
	РС.Прочитать();
	Если РС.Количество() = 0 Тогда
	     //Предупреждение("Записей нет",5,"ЗАПИСИ");
		 //Если БулевоНаФорме = Истина Тогда
		 Документ.НаличиеДокументаОригинала = Ложь;
		 //КонецЕсли;	 
	Иначе
	     //Предупреждение("Записи есть",5,"ЗАПИСИ");
		 //Запись заблокировано
		 //Если БулевоНаФорме = Ложь Тогда
		 Документ.НаличиеДокументаОригинала = Истина;
		 //КонецЕсли;
		 
	КонецЕсли;
	
КонецПроцедуры

Функция ПроверкаЗаписиВРегистреТекущегоДокумента(Документ) Экспорт //:SOV IT EA 
	
		РС = РегистрыСведений.РегистрПараметрыОбъекта.СоздатьНаборЗаписей();
	    РС.Отбор.СсылкаНаДокумент.Установить(Документ.Ссылка);
	    РС.Прочитать();
		Если РС.Количество() > 0 Тогда
		Возврат Истина;
	    Иначе 
		Возврат Ложь;
	    КонецЕсли;	
	
КонецФункции
